<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_39) on Fri Apr 25 14:06:46 CEST 2014 -->
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>
PaymentChannelClient (bitcoinj 0.11.2 API)
</TITLE>

<META NAME="date" CONTENT="2014-04-25">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="PaymentChannelClient (bitcoinj 0.11.2 API)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/PaymentChannelClient.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.Factory.html" title="interface in com.google.bitcoin.protocols.channels"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html" title="class in com.google.bitcoin.protocols.channels"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?com/google/bitcoin/protocols/channels/PaymentChannelClient.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="PaymentChannelClient.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
com.google.bitcoin.protocols.channels</FONT>
<BR>
Class PaymentChannelClient</H2>
<PRE>
<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</A>
  <IMG SRC="../../../../../resources/inherit.gif" ALT="extended by "><B>com.google.bitcoin.protocols.channels.PaymentChannelClient</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.html" title="interface in com.google.bitcoin.protocols.channels">IPaymentChannelClient</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>PaymentChannelClient</B><DT>extends <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A><DT>implements <A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.html" title="interface in com.google.bitcoin.protocols.channels">IPaymentChannelClient</A></DL>
</PRE>

<P>
<p>A class which handles most of the complexity of creating a payment channel connection by providing a
 simple in/out interface which is provided with protobufs from the server and which generates protobufs which should
 be sent to the server.</p>

 <p>Does all required verification of server messages and properly stores state objects in the wallet-attached
 <A HREF="../../../../../com/google/bitcoin/protocols/channels/StoredPaymentChannelClientStates.html" title="class in com.google.bitcoin.protocols.channels"><CODE>StoredPaymentChannelClientStates</CODE></A> so that they are automatically closed when necessary and refund
 transactions are not lost if the application crashes before it unlocks.</p>

 <p>Though this interface is largely designed with stateful protocols (eg simple TCP connections) in mind, it is also
 possible to use it with stateless protocols (eg sending protobufs when required over HTTP headers). In this case, the
 "connection" translates roughly into the server-client relationship. See the javadocs for specific functions for more
 details.</p>
<P>

<P>
<HR>

<P>
<!-- ======== NESTED CLASS SUMMARY ======== -->

<A NAME="nested_class_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Nested Class Summary</B></FONT></TH>
</TR>
</TABLE>
&nbsp;<A NAME="nested_classes_inherited_from_class_com.google.bitcoin.protocols.channels.IPaymentChannelClient"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Nested classes/interfaces inherited from interface com.google.bitcoin.protocols.channels.<A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.html" title="interface in com.google.bitcoin.protocols.channels">IPaymentChannelClient</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.ClientConnection.html" title="interface in com.google.bitcoin.protocols.channels">IPaymentChannelClient.ClientConnection</A>, <A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.Factory.html" title="interface in com.google.bitcoin.protocols.channels">IPaymentChannelClient.Factory</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/locks/ReentrantLock.html?is-external=true" title="class or interface in java.util.concurrent.locks">ReentrantLock</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClient.html#lock">lock</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClient.html#MAX_TIME_WINDOW">MAX_TIME_WINDOW</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The maximum amount of time for which we will accept the server locking up our funds for the multisig
 contract.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClient.html#PaymentChannelClient(com.google.bitcoin.core.Wallet, com.google.bitcoin.core.ECKey, java.math.BigInteger, com.google.bitcoin.core.Sha256Hash, com.google.bitcoin.protocols.channels.IPaymentChannelClient.ClientConnection)">PaymentChannelClient</A></B>(<A HREF="../../../../../com/google/bitcoin/core/Wallet.html" title="class in com.google.bitcoin.core">Wallet</A>&nbsp;wallet,
                     <A HREF="../../../../../com/google/bitcoin/core/ECKey.html" title="class in com.google.bitcoin.core">ECKey</A>&nbsp;myKey,
                     <A HREF="http://docs.oracle.com/javase/6/docs/api/java/math/BigInteger.html?is-external=true" title="class or interface in java.math">BigInteger</A>&nbsp;maxValue,
                     <A HREF="../../../../../com/google/bitcoin/core/Sha256Hash.html" title="class in com.google.bitcoin.core">Sha256Hash</A>&nbsp;serverId,
                     <A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.ClientConnection.html" title="interface in com.google.bitcoin.protocols.channels">IPaymentChannelClient.ClientConnection</A>&nbsp;conn)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructs a new channel manager which waits for <A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClient.html#connectionOpen()"><CODE>connectionOpen()</CODE></A> before acting.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClient.html#connectionClosed()">connectionClosed</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Called when the connection terminates.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClient.html#connectionOpen()">connectionOpen</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Called to indicate the connection has been opened and messages can now be generated for the server.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://docs.oracle.com/javase/6/docs/api/java/math/BigInteger.html?is-external=true" title="class or interface in java.math">BigInteger</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClient.html#getMissing()">getMissing</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the amount of satoshis missing when a server requests too much value.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;com.google.common.util.concurrent.ListenableFuture&lt;<A HREF="http://docs.oracle.com/javase/6/docs/api/java/math/BigInteger.html?is-external=true" title="class or interface in java.math">BigInteger</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClient.html#incrementPayment(java.math.BigInteger)">incrementPayment</A></B>(<A HREF="http://docs.oracle.com/javase/6/docs/api/java/math/BigInteger.html?is-external=true" title="class or interface in java.math">BigInteger</A>&nbsp;size)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Increments the total value which we pay the server.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClient.html#receiveMessage(org.bitcoin.paymentchannel.Protos.TwoWayChannelMessage)">receiveMessage</A></B>(<A HREF="../../../../../org/bitcoin/paymentchannel/Protos.TwoWayChannelMessage.html" title="class in org.bitcoin.paymentchannel">Protos.TwoWayChannelMessage</A>&nbsp;msg)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Called when a message is received from the server.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClient.html#settle()">settle</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Closes the connection, notifying the server it should settle the channel by broadcasting the most recent
 payment transaction.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientState.html" title="class in com.google.bitcoin.protocols.channels">PaymentChannelClientState</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClient.html#state()">state</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the <A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientState.html" title="class in com.google.bitcoin.protocols.channels"><CODE>PaymentChannelClientState</CODE></A> object which stores the current state of the connection with the
 server.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.<A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</A>, <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="lock"><!-- --></A><H3>
lock</H3>
<PRE>
protected final <A HREF="http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/locks/ReentrantLock.html?is-external=true" title="class or interface in java.util.concurrent.locks">ReentrantLock</A> <B>lock</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="MAX_TIME_WINDOW"><!-- --></A><H3>
MAX_TIME_WINDOW</H3>
<PRE>
public long <B>MAX_TIME_WINDOW</B></PRE>
<DL>
<DD><p>The maximum amount of time for which we will accept the server locking up our funds for the multisig
 contract.</p>

 <p>Note that though this is not final, it is in all caps because it should generally not be modified unless you
 have some guarantee that the server will not request at least this (channels will fail if this is too small).</p>

 <p>24 hours is the default as it is expected that clients limit risk exposure by limiting channel size instead of
 limiting lock time when dealing with potentially malicious servers.</p>
<P>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="PaymentChannelClient(com.google.bitcoin.core.Wallet, com.google.bitcoin.core.ECKey, java.math.BigInteger, com.google.bitcoin.core.Sha256Hash, com.google.bitcoin.protocols.channels.IPaymentChannelClient.ClientConnection)"><!-- --></A><H3>
PaymentChannelClient</H3>
<PRE>
public <B>PaymentChannelClient</B>(<A HREF="../../../../../com/google/bitcoin/core/Wallet.html" title="class in com.google.bitcoin.core">Wallet</A>&nbsp;wallet,
                            <A HREF="../../../../../com/google/bitcoin/core/ECKey.html" title="class in com.google.bitcoin.core">ECKey</A>&nbsp;myKey,
                            <A HREF="http://docs.oracle.com/javase/6/docs/api/java/math/BigInteger.html?is-external=true" title="class or interface in java.math">BigInteger</A>&nbsp;maxValue,
                            <A HREF="../../../../../com/google/bitcoin/core/Sha256Hash.html" title="class in com.google.bitcoin.core">Sha256Hash</A>&nbsp;serverId,
                            <A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.ClientConnection.html" title="interface in com.google.bitcoin.protocols.channels">IPaymentChannelClient.ClientConnection</A>&nbsp;conn)</PRE>
<DL>
<DD>Constructs a new channel manager which waits for <A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClient.html#connectionOpen()"><CODE>connectionOpen()</CODE></A> before acting.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>wallet</CODE> - The wallet which will be paid from, and where completed transactions will be committed.
               Must already have a <A HREF="../../../../../com/google/bitcoin/protocols/channels/StoredPaymentChannelClientStates.html" title="class in com.google.bitcoin.protocols.channels"><CODE>StoredPaymentChannelClientStates</CODE></A> object in its extensions set.<DD><CODE>myKey</CODE> - A freshly generated keypair used for the multisig contract and refund output.<DD><CODE>maxValue</CODE> - The maximum value the server is allowed to request that we lock into this channel until the
                 refund transaction unlocks. Note that if there is a previously open channel, the refund
                 transaction used in this channel may be larger than maxValue. Thus, maxValue is not a method for
                 limiting the amount payable through this channel.<DD><CODE>serverId</CODE> - An arbitrary hash representing this channel. This must uniquely identify the server. If an
                 existing stored channel exists in the wallet's <A HREF="../../../../../com/google/bitcoin/protocols/channels/StoredPaymentChannelClientStates.html" title="class in com.google.bitcoin.protocols.channels"><CODE>StoredPaymentChannelClientStates</CODE></A>, then an
                 attempt will be made to resume that channel.<DD><CODE>conn</CODE> - A callback listener which represents the connection to the server (forwards messages we generate to
             the server)</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getMissing()"><!-- --></A><H3>
getMissing</H3>
<PRE>
public <A HREF="http://docs.oracle.com/javase/6/docs/api/java/math/BigInteger.html?is-external=true" title="class or interface in java.math">BigInteger</A> <B>getMissing</B>()</PRE>
<DL>
<DD><p>Returns the amount of satoshis missing when a server requests too much value.</p>

 <p>When InsufficientMoneyException is thrown due to the server requesting too much value, an instance of 
 PaymentChannelClient needs access to how many satoshis are missing.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="receiveMessage(org.bitcoin.paymentchannel.Protos.TwoWayChannelMessage)"><!-- --></A><H3>
receiveMessage</H3>
<PRE>
public void <B>receiveMessage</B>(<A HREF="../../../../../org/bitcoin/paymentchannel/Protos.TwoWayChannelMessage.html" title="class in org.bitcoin.paymentchannel">Protos.TwoWayChannelMessage</A>&nbsp;msg)
                    throws <A HREF="../../../../../com/google/bitcoin/core/InsufficientMoneyException.html" title="class in com.google.bitcoin.core">InsufficientMoneyException</A></PRE>
<DL>
<DD>Called when a message is received from the server. Processes the given message and generates events based on its
 content.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.html#receiveMessage(org.bitcoin.paymentchannel.Protos.TwoWayChannelMessage)">receiveMessage</A></CODE> in interface <CODE><A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.html" title="interface in com.google.bitcoin.protocols.channels">IPaymentChannelClient</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/google/bitcoin/core/InsufficientMoneyException.html" title="class in com.google.bitcoin.core">InsufficientMoneyException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="connectionClosed()"><!-- --></A><H3>
connectionClosed</H3>
<PRE>
public void <B>connectionClosed</B>()</PRE>
<DL>
<DD><p>Called when the connection terminates. Notifies the <CODE>StoredClientChannel</CODE> object that we can attempt to
 resume this channel in the future and stops generating messages for the server.</p>

 <p>For stateless protocols, this translates to a client not using the channel for the immediate future, but
 intending to reopen the channel later. There is likely little reason to use this in a stateless protocol.</p>

 <p>Note that this <b>MUST</b> still be called even after either
 <CODE>ClientConnection#destroyConnection(com.google.bitcoin.protocols.channels.PaymentChannelCloseException.CloseReason)</CODE> or
 <A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClient.html#settle()"><CODE>settle()</CODE></A> is called, to actually handle the connection close logic.</p>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.html#connectionClosed()">connectionClosed</A></CODE> in interface <CODE><A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.html" title="interface in com.google.bitcoin.protocols.channels">IPaymentChannelClient</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="settle()"><!-- --></A><H3>
settle</H3>
<PRE>
public void <B>settle</B>()
            throws <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</A></PRE>
<DL>
<DD><p>Closes the connection, notifying the server it should settle the channel by broadcasting the most recent
 payment transaction.</p>

 <p>Note that this only generates a CLOSE message for the server and calls
 <CODE>ClientConnection#destroyConnection(CloseReason)</CODE> to settle the connection, it does not
 actually handle connection close logic, and <A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClient.html#connectionClosed()"><CODE>connectionClosed()</CODE></A> must still be called
 after the connection fully closes.</p>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.html#settle()">settle</A></CODE> in interface <CODE><A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.html" title="interface in com.google.bitcoin.protocols.channels">IPaymentChannelClient</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</A></CODE> - If the connection is not currently open (ie the CLOSE message cannot be sent)</DL>
</DD>
</DL>
<HR>

<A NAME="connectionOpen()"><!-- --></A><H3>
connectionOpen</H3>
<PRE>
public void <B>connectionOpen</B>()</PRE>
<DL>
<DD><p>Called to indicate the connection has been opened and messages can now be generated for the server.</p>

 <p>Attempts to find a channel to resume and generates a CLIENT_VERSION message for the server based on the
 result.</p>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.html#connectionOpen()">connectionOpen</A></CODE> in interface <CODE><A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.html" title="interface in com.google.bitcoin.protocols.channels">IPaymentChannelClient</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="state()"><!-- --></A><H3>
state</H3>
<PRE>
public <A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientState.html" title="class in com.google.bitcoin.protocols.channels">PaymentChannelClientState</A> <B>state</B>()</PRE>
<DL>
<DD><p>Gets the <A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientState.html" title="class in com.google.bitcoin.protocols.channels"><CODE>PaymentChannelClientState</CODE></A> object which stores the current state of the connection with the
 server.</p>

 <p>Note that if you call any methods which update state directly the server will not be notified and channel
 initialization logic in the connection may fail unexpectedly.</p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="incrementPayment(java.math.BigInteger)"><!-- --></A><H3>
incrementPayment</H3>
<PRE>
public com.google.common.util.concurrent.ListenableFuture&lt;<A HREF="http://docs.oracle.com/javase/6/docs/api/java/math/BigInteger.html?is-external=true" title="class or interface in java.math">BigInteger</A>&gt; <B>incrementPayment</B>(<A HREF="http://docs.oracle.com/javase/6/docs/api/java/math/BigInteger.html?is-external=true" title="class or interface in java.math">BigInteger</A>&nbsp;size)
                                                                                throws <A HREF="../../../../../com/google/bitcoin/protocols/channels/ValueOutOfRangeException.html" title="class in com.google.bitcoin.protocols.channels">ValueOutOfRangeException</A>,
                                                                                       <A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</A></PRE>
<DL>
<DD>Increments the total value which we pay the server. Note that the amount of money sent may not be the same as the
 amount of money actually requested. It can be larger if the amount left over in the channel would be too small to
 be accepted by the Bitcoin network. ValueOutOfRangeException will be thrown, however, if there's not enough money
 left in the channel to make the payment at all. Only one payment can be in-flight at once. You have to ensure
 you wait for the previous increase payment future to complete before incrementing the payment again.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.html#incrementPayment(java.math.BigInteger)">incrementPayment</A></CODE> in interface <CODE><A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.html" title="interface in com.google.bitcoin.protocols.channels">IPaymentChannelClient</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>size</CODE> - How many satoshis to increment the payment by (note: not the new total).
<DT><B>Returns:</B><DD>a future that completes when the server acknowledges receipt and acceptance of the payment.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/google/bitcoin/protocols/channels/ValueOutOfRangeException.html" title="class in com.google.bitcoin.protocols.channels">ValueOutOfRangeException</A></CODE> - If the size is negative or would pay more than this channel's total value
                                  (<A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html#state()"><CODE>PaymentChannelClientConnection.state()</CODE></A>.getTotalValue())
<DD><CODE><A HREF="http://docs.oracle.com/javase/6/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</A></CODE> - If the channel has been closed or is not yet open
                               (see <A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html#getChannelOpenFuture()"><CODE>PaymentChannelClientConnection.getChannelOpenFuture()</CODE></A> for the second)</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/PaymentChannelClient.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../com/google/bitcoin/protocols/channels/IPaymentChannelClient.Factory.html" title="interface in com.google.bitcoin.protocols.channels"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html" title="class in com.google.bitcoin.protocols.channels"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?com/google/bitcoin/protocols/channels/PaymentChannelClient.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="PaymentChannelClient.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright &#169; 2014. All rights reserved.
</BODY>
</HTML>
